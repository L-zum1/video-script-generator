# 🔧 故障排除指南

## ❌ 无法连接服务器

### 步骤 1: 确认服务器是否运行

在终端运行：
```bash
python3 app.py
```

**应该看到类似输出：**
```
✅ 成功导入 untils 模块
============================================================
🚀 Flask 服务器正在启动...
📡 监听地址: http://0.0.0.0:5001
🌐 本地访问: http://localhost:5001
🌐 网络访问: http://127.0.0.1:5001
============================================================
📝 请在浏览器中访问上述地址之一
```

**如果没有看到这些信息，说明服务器没有启动成功！**

### 步骤 2: 检查常见错误

#### 错误 1: 模块导入失败
```
❌ 导入 untils 模块失败: ...
```
**解决方法：**
- 检查 `untils.py` 文件是否存在
- 检查文件是否有语法错误
- 确保在项目根目录运行

#### 错误 2: 端口被占用
```
Address already in use
Port 5001 is in use...
```
**解决方法：**
- 应用会自动尝试其他端口（5002, 5003...）
- 或者手动关闭占用端口的程序

#### 错误 3: 依赖未安装
```
ModuleNotFoundError: No module named 'flask'
```
**解决方法：**
```bash
pip3 install Flask flask-cors
```

### 步骤 3: 使用测试脚本

运行测试脚本检查服务器：
```bash
python3 test_server.py
```

这会自动测试服务器连接并显示详细诊断信息。

### 步骤 4: 检查浏览器访问

**❌ 错误做法：**
- 直接双击打开 `main.html` 文件
- 使用 `file://` 协议访问

**✅ 正确做法：**
1. 启动 Flask 服务器：`python3 app.py`
2. 复制终端显示的地址（如 `http://localhost:5001`）
3. 在浏览器地址栏输入该地址
4. 按回车访问

### 步骤 5: 检查浏览器控制台

1. 按 `F12` 打开开发者工具
2. 切换到 "Console"（控制台）标签
3. 查看是否有错误信息
4. 查看是否有 "✅ 服务器连接正常" 的消息

### 步骤 6: 手动测试 API

在浏览器中直接访问：
```
http://localhost:5001/api/health
```

**应该看到：**
```json
{"message":"服务器运行正常","status":"ok","port":"5001"}
```

如果看到这个，说明服务器正常，问题在前端。

### 步骤 7: 检查防火墙

macOS 可能阻止了连接：
1. 系统设置 → 网络 → 防火墙
2. 确保防火墙没有阻止 Python

### 步骤 8: 尝试不同端口

如果默认端口有问题，可以手动指定：
```python
# 在 app.py 最后一行改为：
app.run(debug=True, host='127.0.0.1', port=8080)
```

然后访问：`http://127.0.0.1:8080`

## 🆘 仍然无法解决？

请提供以下信息：
1. 终端中 `python3 app.py` 的完整输出
2. 浏览器控制台（F12）的错误信息
3. 浏览器地址栏的完整 URL
4. 运行 `python3 test_server.py` 的输出
